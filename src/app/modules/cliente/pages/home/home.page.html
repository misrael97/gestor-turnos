<ion-content class="ion-padding">
  <h1>¡Bienvenido!</h1>

  <!-- Selector de sucursal -->
  <ion-item>
    <ion-label position="stacked">Selecciona una sucursal</ion-label>
    <ion-select [(ngModel)]="sucursalSeleccionada" placeholder="Elige una sucursal">
      <ion-select-option *ngFor="let sucursal of sucursales" [value]="sucursal.id">
        {{ sucursal.nombre }} - {{ sucursal.direccion }}
      </ion-select-option>
    </ion-select>
  </ion-item>

  <ion-button expand="block" color="primary" (click)="obtenerTurno()" [disabled]="loading || !sucursalSeleccionada">
    <ion-spinner *ngIf="loading" name="crescent"></ion-spinner>
    <span *ngIf="!loading">Obtener un Número de Turno</span>
  </ion-button>

  <ion-card>
    <ion-card-header>
      <ion-card-title>Citas Programadas</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <p>Solicita tu turno en línea antes de llegar a la sucursal.</p>
      
      <!-- Selector de fecha -->
      <ion-item>
        <ion-label position="stacked">Fecha de la cita</ion-label>
        <ion-datetime 
          displayFormat="DD/MM/YYYY" 
          [(ngModel)]="fechaCita"
          [min]="fechaMinima"
          [max]="fechaMaxima"
          placeholder="Selecciona una fecha">
        </ion-datetime>
      </ion-item>

      <!-- Selector de hora -->
      <ion-item>
        <ion-label position="stacked">Hora de la cita</ion-label>
        <ion-datetime 
          displayFormat="HH:mm" 
          [(ngModel)]="horaCita"
          minuteValues="0,15,30,45"
          placeholder="Selecciona una hora">
        </ion-datetime>
      </ion-item>

      <ion-button 
        expand="block" 
        color="primary" 
        (click)="solicitarTurnoEnLinea()" 
        [disabled]="loading || !sucursalSeleccionada || !fechaCita || !horaCita">
        <ion-spinner *ngIf="loading" name="crescent"></ion-spinner>
        <span *ngIf="!loading">Solicitar Turno en Línea</span>
      </ion-button>
    </ion-card-content>
  </ion-card>

  <ion-item>
    <ion-icon name="time-outline" slot="start"></ion-icon>
    <ion-label>Tiempo de espera estimado: {{ tiempoEstimado }} min</ion-label>
  </ion-item>
</ion-content>
