<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Bienvenido</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <ion-card>
    <ion-card-header>
      <ion-card-title>
        <ion-icon name="location-outline" slot="start"></ion-icon>
        Selecciona una sucursal
      </ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-item>
        <ion-label position="stacked">Sucursal</ion-label>
        <ion-select [(ngModel)]="sucursalSeleccionada" placeholder="Elige una sucursal">
          <ion-select-option *ngFor="let sucursal of sucursales" [value]="sucursal.id">
            {{ sucursal.nombre }} - {{ sucursal.direccion }}
          </ion-select-option>
        </ion-select>
      </ion-item>

      <ion-button expand="block" color="primary" (click)="obtenerTurno()" [disabled]="loading || !sucursalSeleccionada">
        <ion-spinner *ngIf="loading" name="crescent"></ion-spinner>
        <ion-label *ngIf="!loading">Obtener un Número de Turno</ion-label>
      </ion-button>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header>
      <ion-card-title>Citas Programadas</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-text>
        <ion-label>Solicita tu turno en línea antes de llegar a la sucursal.</ion-label>
      </ion-text>
      
      <!-- Selector de fecha -->
      <ion-item>
        <ion-label position="stacked">Fecha de la cita</ion-label>
        <ion-datetime 
          displayFormat="DD/MM/YYYY" 
          [(ngModel)]="fechaCita"
          [min]="fechaMinima"
          [max]="fechaMaxima"
          placeholder="Selecciona una fecha">
        </ion-datetime>
      </ion-item>

      <!-- Selector de hora -->
      <ion-item>
        <ion-label position="stacked">Hora de la cita</ion-label>
        <ion-datetime 
          displayFormat="HH:mm" 
          [(ngModel)]="horaCita"
          minuteValues="0,15,30,45"
          placeholder="Selecciona una hora">
        </ion-datetime>
      </ion-item>

      <ion-button 
        expand="block" 
        color="primary" 
        (click)="solicitarTurnoEnLinea()" 
        [disabled]="loading || !sucursalSeleccionada || !fechaCita || !horaCita">
        <ion-spinner *ngIf="loading" name="crescent"></ion-spinner>
        <ion-label *ngIf="!loading">Solicitar Turno en Línea</ion-label>
      </ion-button>
    </ion-card-content>
  </ion-card>

  <ion-item>
    <ion-icon name="time-outline" slot="start"></ion-icon>
    <ion-label>Tiempo de espera estimado: {{ tiempoEstimado }} min</ion-label>
  </ion-item>
</ion-content>
