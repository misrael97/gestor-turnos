<ion-content>
  <ion-refresher slot="fixed" (ionRefresh)="cargarAlertas($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <div class="ion-padding">
    <ion-spinner *ngIf="loading" name="crescent"></ion-spinner>

    <ion-list *ngIf="!loading && alertas.length > 0">
      <ion-item-sliding *ngFor="let alerta of alertas">
        <ion-item [color]="alerta.leida ? 'light' : ''">
          <ion-icon 
            [name]="getColor(alerta.tipo) === 'success' ? 'checkmark-circle' : getColor(alerta.tipo) === 'warning' ? 'warning' : 'alert-circle'" 
            [color]="getColor(alerta.tipo)" 
            slot="start">
          </ion-icon>
          <ion-label>
            <h2 [class.ion-text-wrap]="true">{{ alerta.mensaje }}</h2>
            <p class="ion-text-muted">{{ alerta.created_at | date:'short' }}</p>
          </ion-label>
          <ion-badge *ngIf="!alerta.leida" color="primary" slot="end">Nueva</ion-badge>
        </ion-item>
        
        <ion-item-options side="end" *ngIf="!alerta.leida">
          <ion-item-option color="primary" (click)="marcarComoLeida(alerta)">
            <ion-icon name="checkmark" slot="icon-only"></ion-icon>
          </ion-item-option>
        </ion-item-options>
      </ion-item-sliding>
    </ion-list>

    <div *ngIf="!loading && alertas.length === 0" class="ion-text-center" style="margin-top: 50px;">
      <ion-icon name="notifications-off-outline" style="font-size: 64px; color: #ccc;"></ion-icon>
      <h3>No tienes alertas</h3>
      <p class="ion-text-muted">Aquí aparecerán tus notificaciones</p>
    </div>
  </div>
</ion-content>
